<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>understanding Cross Entrophy | 成长的烦恼</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/font.css"><link rel="stylesheet" type="text/css" href="/css/noise.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><article class="wrapper"><div class="post-main"><div class="nav"><nav class="container"><a class="sidebar-nav-item active" href="/">Home</a><a class="sidebar-nav-item" href="/archives">Archives</a></nav><div class="container post-meta"><div class="post-time">2018-12-22</div></div></div><div class="container post-header"><h1>understanding Cross Entrophy</h1></div><div class="container post-toc"><details class="toc"><summary class="toc-accordion">Table of Contents</summary><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#直观理解"><span class="toc-number">1.</span> <span class="toc-text">直观理解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#信息熵"><span class="toc-number">1.1.</span> <span class="toc-text">信息熵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#交叉熵"><span class="toc-number">1.2.</span> <span class="toc-text">交叉熵</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reference"><span class="toc-number">1.3.</span> <span class="toc-text">Reference</span></a></li></ol></li></ol></details></div><div class="container post-content"><p>在我们使用Softmax将特征向量映射成概率值之后，我们需要一个指标来评价预测出来的概率值的好坏，通常，我们使用的就是cross-entrophy loss，即交叉熵损失。交叉熵损失的计算公式是：$ L = -(ylog\hat{y} + (1-y)log(1-\hat{y})) $。其中， $\hat{y}$ 表示预测出的概率值，而 $y$ 表示实际的分类标签值。</p>
<h2 id="直观理解"><a class="header-anchor" href="#直观理解"></a>直观理解</h2>
<p>我们已知的是现在真实的标签，假设这就是整体数据的分布，那么我们要让这个分布的概率最大，也就是说，当标签是 $y_i$ 时，我们让预测值 $\hat{y}$ 最大，可以表示成 $\hat{y}^{y_i}$ ，将每种可能的 $y_i$ 情况相乘，最终得到 $\hat{y}<sup>{y}*(1-\hat{y})</sup>{1-y}$ 这样的形式，然后对这个函数求$log$，最大化这个数 $L_{tmp}$ ，就是最小化 $-L_{tmp}=L=-(ylog\hat{y}+ (1-y)log(1-\hat{y})$，其实这就是极大似然的原理和推导过程。</p>
<p>但是为什么这个被叫做交叉熵损失呢？我们再尝试从熵的角度去理解这个损失所代表的含义。</p>
<h3 id="信息熵"><a class="header-anchor" href="#信息熵"></a>信息熵</h3>
<p>在理解交叉熵之前，我们先复习一下什么是熵。熵是香农信息论里的概念，表示的是信息的复杂度，或者信息量的大小。我们通常说的信息量大，其实就是说这件事的不确定性更大，平时发生的概率小，比如说刘恺威和杨幂离婚了！一个大瓜的那种感觉。</p>
<p>香农把这种感觉用了定量的方式去定义，我们传递信息需要用语言，用文字，如果认为有个码本去传递信息，那么熵就是在特定的概率分布 $p$ 下，传递所有事件所需要的最小的平均码长。平均码长越长，说明分布下的事件越复杂。比如，平均码长是0，那说明没有信息需要传递，事件发生的概率是1。</p>
<p>信息熵可以表示成 $H§=\sum_{x}p(x)*len(x)$ ，即 $x$ 发生的概率乘以它的编码长度，因为是最小的平均编码，那么需要当事件发生的概率大的时候，它的编码长度更小，这样总体的编码长度就小。这是一个直观想法，那怎么计算具体的编码长度 $len(x)$ 呢？</p>
<p>当我们进行变长编码的时候，我们需要保证每个编码是唯一的，且不能是其他编码的前缀，否则会出现解析的问题，比如二进制编码中，如果把1作为一个事件的编码，那么10,
11, 100, 101, …, 全部不可以作为其他时间的编码。就像是，我们为了一颗树，放弃了这颗树背后的森林。假设编码长度是$L$，那么放弃的就是$\int_{L}^{\infty} \frac{1}{2^L} dL$ ，求出来是$\frac{1}{2^L}ln2$ ， 如果是以$e$为底，则就是$\frac{1}{2^L}$。因为当 $p(x)$ 越大的时候，我们越愿意放弃更多的森林来让总体的码长更短，因此另 $p(x)=\frac{1}{2^L}$，即码长 $L=log_{2}{\frac{1}{p(x)}}$。所以信息熵为：
$ H§=\sum_xp(x)*log_2(\frac{1}{p(x)})$ 。</p>
<h3 id="交叉熵"><a class="header-anchor" href="#交叉熵"></a>交叉熵</h3>
<p>如果分布p和分布q传递相同的一些时间，但是事件发生的概率不同，在分布q中，我们依然用刚才根据分布p得出的码本，那么总的编码长度就是:
$ H_{p}(q) = \sum_x{q(x) \log_2{\frac{1}{p(x)}} } $
，即交叉熵，这个熵值越大，说明分布p和分布q的差距越大。回到我们最初的场景，我们知道真实标签$y$ 和计算出的分类概率
$\hat{y}$，于是我们计算出在真实分布的情况下预测出的信息熵，即:
$\sum_y{\log(\frac{1}{\hat{y}}) + (1-y) \log( \frac{1}{1-\hat{y}}) }$。我们要最小化这个信息熵，也就是使预测出来的概率分布接近于真实的概率分布。</p>
<h3 id="reference"><a class="header-anchor" href="#reference"></a>Reference</h3>
<p>[1] <a href="http://colah.github.io/posts/2015-09-Visual-Information/" target="_blank" rel="noopener">http://colah.github.io/posts/2015-09-Visual-Information/</a></p>
</div></div><script type="text/x-mathjax-config">
   MathJax.Hub.Config({"HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"], linebreaks: { automatic:true }, EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50) },
        tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno",skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']},
        TeX: {  noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } }, Macros: { href: "{}" } },
        messageStyle: "none"
    }); 
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><div class="post-main post-comment"></div></article><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
  $(".fancybox").fancybox();
});
</script></body></html>